<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head>
        <w2:type>COMPONENT</w2:type>
        <w2:buildDate/>
        <w2:MSA/>
        <xf:model>
            <w2:dataCollection baseNode="map"/>
            <w2:workflowCollection/>
        </xf:model>
        <w2:layoutInfo/>
        <w2:publicInfo method=""/>
		<script type="text/javascript" src="/js/lib/qrcode.min.js"></script>
        <script lazy="false" type="text/javascript"><![CDATA[
scwin.onpageload = function() {
	common.setScopeObj(scwin);

	var paramData = $p.getParameter("param");

    var qrcodeID = paramData.data.historyCnt;

    var userName = paramData.data.user_name;
	whive_event_text.setLabel("<b>"+userName + "ë‹˜ W-Hive ì°¸ì—¬ ì´ë²¤íŠ¸ ë‹¹ì²¨</b>ì„ ì¶•í•˜ë“œë¦½ë‹ˆë‹¤! ğŸ¥³<br/><br/>");
	whive_event_longtext.setLabel("W-Hiveì— ê´€ì‹¬ì„ ê°–ê³  ì•±ì„ ìƒì„±í•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.<br/>ê°€ì…í•˜ì‹¤ ë•Œ ê¸°ì¬í•˜ì‹  í•¸ë“œí° ë²ˆí˜¸ë¡œ " +
			"<span style='background-color:#fff68e'>ì‹ ì„¸ê³„ ìƒí’ˆê¶Œ 1ë§Œì›ê¶Œ</span>ì„<br/> 9ì›” 12ì¼ ì´í›„ ìˆœì°¨ ì¦ì •í•  ì˜ˆì •ì…ë‹ˆë‹¤." +
			"<br/><br/>ë°‘ì— ë¦¬ë·° ì‘ì„± ì‹œ, ì¶”ì²¨ì„ í†µí•´ <span style='background-color:#fff68e'>ì¶”ê°€ ìƒí’ˆ</span>ì„ ë“œë¦¬ë‹ˆ ë†“ì¹˜ì§€ ë§ˆì„¸ìš”!");

	scwin.buildAfterQrcodeCreateByID(qrcodeID);

};

scwin.btn_submit_onclick = function(e) {

    // ìµœì†Œ 20ê¸€ì ì…ë ¥ ì¡°ê±´ ì¶”ê°€
	var comment = build_event_textarea.getValue();

    if(comment.length < 20){

        alert("ìµœì†Œ 20ê¸€ì ì…ë ¥í•´ì•¼í•©ë‹ˆë‹¤.");
        return false;
	}

    if(comment.length > 400){

		alert("ìµœëŒ€ 400ê¸€ìê¹Œì§€ ì…ë ¥ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
		return false;
	}

	// ajax submit
	var data = {};
    data.comment = comment;


	$.ajax({
			url : "/manager/build/history/whiveEvent",
			type : "post",
			accept : "application/json",
			contentType : "application/json; charset=utf-8",
			data : JSON.stringify(data),
			dataType : "json",
			success : function(r,status) {
				// alert(r);
				// alert(status);
				if(status === "success"){
					// alert("ì´ë²¤íŠ¸ ë“±ë¡ì´ ì™„ë£Œ ë˜ì—ˆìŠµë‹ˆë‹¤.");

					popup_window_wframe.close();

					var opts = {
						"id":"popup2",
						"width": 380,
						"height": 223,
						"name":"ì•Œë¦¼"
					};

					common.win.alert("ë¦¬ë·°ì´ë²¤íŠ¸ ë“±ë¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.",function(){
						// console.log("user close");

					},opts);



				}

			},
			error:function(request,status,error){
				var message = request.responseJSON;

				alert("message:"+message[0].result+"\n");
				popup_window_wframe.close();
			}

	});


};

function getTextLength(str) {
	var len = 0;

	for (var i = 0; i < str.length; i++) {
		if (escape(str.charAt(i)).length == 6) {
			len++;
		}
		len++;
	}
	return len;
}

scwin.btn_event_textarea_keyup = function(e){

    var comment = this.getValue();
	current.setLabel(comment.length); // ì‹¤ì‹œê°„ ê¸€ììˆ˜ ì¹´ìš´íŒ…
	if(comment.length>20){
		current.setStyle("color","#000000");
	}

	if(comment.length > 400){
        alert("ìµœëŒ€ 400ìê¹Œì§€ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
        this.getValue(comment.substring(0,400));
		current.setLabel("400"); // ì‹¤ì‹œê°„ ê¸€ììˆ˜ ì¹´ìš´íŒ…
	}

};

scwin.reviewLengthValidate = function(value){
	if(value.length < 20){
		current.setStyle("color","#ff0000");
	} else {
		current.setStyle("color","#000000");
	}
	return value;
};

scwin.btn_cancel_onclick = function(){

	popup_window_wframe.close();

};

scwin.buildAfterQrcodeCreateByID = function(qrcodeID){
	// console.log(g_config.HTTPSERVER_URL);
	var qrcode = new QRCode(document.getElementById("build_event_qrcode"),{
		text: g_config.HTTPSERVER_URL + "/builder/build/history/CheckAuthPopup/"+parseInt(qrcodeID),
		width: 120,
		height: 120,
		colorDark : "#000000",
		colorLight : "#ffffff",
		correctLevel : QRCode.CorrectLevel.H
	});

};


]]></script>
<style>

	.w2window_header { display:none; }

	.w2window_body { top: 0px; }

	.w2window {
	position: absolute;
	background-color: #fff;
	border: 0px;
	}

	.w2window_restored {
	top:50% !important;
	left:50% !important;
	transform: translateX(-50%) translateY(-50%);
	}

	.flex_container {
	display: flex;
	align-items: center;
	justify-content: space-between;
	}

	.w2tb .w2tb_th {
	text-align: center;
	background: #FFFFFF;
	border: 0px;
	}

	.w2tb .w2tb_td {
	margin: 0;
	border: 0px;
	vertical-align: middle;
	}

	.w2popup_window .w2window_content {
	top:0px;
	bottom:0px;
	left:0px;
	right:0px;
	border-top:0px;
	border-left:0px;
	border-right:0px;
	border-bottom:0px;
	}

	.submit_btn {
	display: inline-block;
	height: 28px;
	padding: 0 12px;
	line-height: 26px;
	font-size: 12px;
	color: #ffffff;
	background: #8851da;
	vertical-align: top;
	border:0px;
	border-radius: 3px;
	}
	.cancel_btn {
		display: inline-block;
		height: 28px;
		padding: 0 12px;
		line-height: 26px;
		font-size: 12px;
		color: #ffffff;
		background: #a4a4a4;
		vertical-align: top;
		border:0px;
		border-radius: 3px;
	}
</style>
    </head>
    <body ev:onpageload="scwin.onpageload">
    <xf:group id="" style="padding:24px 26px 0px 24px;"><xf:group tagname="table" style="width:100%;" id="" class="w2tb">
    		<w2:attributes>
    			<w2:summary></w2:summary>
    		</w2:attributes>
    		<xf:group tagname="caption"></xf:group>
    		<xf:group tagname="colgroup">
    			<xf:group tagname="col" style="width:30.00%"></xf:group>
    			<xf:group tagname="col" style="width:70.00%"></xf:group>
    		</xf:group>
    		<xf:group tagname="tr">
    			<xf:group tagname="th" style="vertical-align:top;padding: 8px 24px 8px 8px;" class="w2tb_th">
    				<w2:attributes>
    					<w2:scope>row</w2:scope>
    				</w2:attributes>
<!--    				<xf:image src="sample_qr.png" style="width:120px;height:120px;" id=""></xf:image>-->
					<div id="build_event_qrcode" style="width: 120px;height:120px;margin: auto;"></div>
    			</xf:group>
    			<xf:group tagname="td" style="vertical-align:top;" class="w2tb_td">
    				<w2:textbox id="whive_event_text" label="XXë‹˜ W-Hive ì°¸ì—¬ ì´ë²¤íŠ¸ ë‹¹ì²¨ì„ ì¶•í•˜ë“œë¦½ë‹ˆë‹¤! ğŸ¥³&lt;br/&gt; &lt;br/&gt;" style="width: 100%; font-size: medium"></w2:textbox>
<!--					<w2:textbox style="width: 100%;" id=""-->
<!--								label="W-Hiveì— ê´€ì‹¬ì„ ê°–ê³  ì•±ì„ ìƒì„±í•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.&lt;br/&gt;ê°€ì…í•˜ì‹¤ ë•Œ ê¸°ì¬í•˜ì‹  í•¸ë“œí° ë²ˆí˜¸ë¡œ ì‹ ì„¸ê³„ ìƒí’ˆê¶Œ 1ë§Œì›ê¶Œì„&lt;br/&gt; 9ì›” 12ì¼ ì´í›„ ìˆœì°¨ ì¦ì •í•  ì˜ˆì •ì…ë‹ˆë‹¤.&lt;br/&gt;&lt;br/&gt;ë°‘ì— ë¦¬ë·° ì‘ì„± ì‹œ, ì¶”ì²¨ì„ í†µí•´ ì¶”ê°€ ìƒí’ˆì„ ë“œë¦¬ë‹ˆ ë†“ì¹˜ì§€ ë§ˆì„¸ìš”!">-->
<!--					</w2:textbox>-->
    				<w2:textbox style="width: 100%;" id="whive_event_longtext"
    					label="W-Hiveì— ê´€ì‹¬ì„ ê°–ê³  ì•±ì„ ìƒì„±í•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.&lt;br/&gt;ê°€ì…í•˜ì‹¤ ë•Œ ê¸°ì¬í•˜ì‹  í•¸ë“œí° ë²ˆí˜¸ë¡œ ì‹ ì„¸ê³„ ìƒí’ˆê¶Œ 1ë§Œì›ê¶Œì„&lt;br/&gt; 9ì›” 12ì¼ ì´í›„ ìˆœì°¨ ì¦ì •í•  ì˜ˆì •ì…ë‹ˆë‹¤.&lt;br/&gt;&lt;br/&gt;ë°‘ì— ë¦¬ë·° ì‘ì„± ì‹œ, ì¶”ì²¨ì„ í†µí•´ ì¶”ê°€ ìƒí’ˆì„ ë“œë¦¬ë‹ˆ ë†“ì¹˜ì§€ ë§ˆì„¸ìš”!">
    				</w2:textbox>
    			</xf:group>
    		</xf:group>
    		<xf:group tagname="tr">
    			<xf:group tagname="th" style="vertical-align:top;padding: 8px 24px 0px 8px;" class="w2tb_th">
    				<w2:attributes>
    					<w2:scope>row</w2:scope>
    				</w2:attributes>
    				<w2:textbox id="" label="QRCode" style="width: 100%;height: 35px; font-weight:bold;font-size: x-large;padding: 8px 0px 8px;"></w2:textbox>
					<w2:textbox id="" label="ì¹´ë©”ë¼ì•±ìœ¼ë¡œ ìŠ¤ìº”í•˜ì‹œë©´&lt;br/&gt;ì„¤ì¹˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤" style="font-size: smaller;"></w2:textbox>
    			</xf:group>
    			<xf:group tagname="td" style="" class="w2tb_td">

    				<xf:textarea minlength="20" maxlength="400" style="width: 100%;height: 100px;" id="build_event_textarea" placeholder="ìµœì†Œ 20ì ì´ìƒ ì…ë ¥í•´ì•¼í•©ë‹ˆë‹¤." validator="scwin.reviewLengthValidate" ev:onkeyup="scwin.btn_event_textarea_keyup"></xf:textarea>
					<xf:group style="float:right;" id="theCount">
						<w2:span label="0" style="color:#ff0000;" id="current"></w2:span>
						<w2:span label=" / 400" style="" id="maximum"></w2:span>
					</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group tagname="tr">
    			<xf:group tagname="th" style="" class="w2tb_th">
    				<w2:attributes>
    					<w2:scope>row</w2:scope>
    				</w2:attributes>
    			</xf:group>
    			<xf:group tagname="td" style="" class="w2tb_td">
					<xf:group id="" style="" class="flex_container">
						<xf:trigger type="button" style="width: 80px;height: 23px; margin-top:35px;" id="btn_submit" class="submit_btn" ev:onclick="scwin.btn_submit_onclick">
							<xf:label><![CDATA[ë¦¬ë·°ë“±ë¡]]></xf:label>
						</xf:trigger>
						<xf:trigger type="button" style="width: 80px;height: 23px; margin-top:35px;" id="btn_cancel" class="cancel_btn" ev:onclick="scwin.btn_cancel_onclick">
							<xf:label><![CDATA[ë‹«ê¸°]]></xf:label>
						</xf:trigger>
					</xf:group>
    			</xf:group>
    		</xf:group>
    	</xf:group></xf:group></body>
</html>
