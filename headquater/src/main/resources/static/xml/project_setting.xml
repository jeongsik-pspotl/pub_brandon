<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head>
    	<w2:type>DEFAULT</w2:type>
        <w2:buildDate/>
        <xf:model>
            <xf:instance>
                <data xmlns=""/>
            </xf:instance>
            <w2:dataCollection baseNode="map">
                <w2:dataList id="dtl_steps" saveRemovedData="true">
                    <w2:columnInfo>
                        <w2:column id="INDEX" name="INDEX" dataType="text"></w2:column>
                        <w2:column id="FRAMEID" name="FRAMEID" dataType="text"></w2:column>
                        <w2:column id="FRAMESRC" name="FRAMESRC" dataType="text"></w2:column>
                        <w2:column id="MENUID" name="MENUID" dataType="text"></w2:column>
                    </w2:columnInfo>
                    <w2:data use="true">
                        <w2:row>
                            <INDEX><![CDATA[1]]></INDEX>
                            <FRAMEID><![CDATA[wfm_project_setting_step1]]></FRAMEID>
                            <FRAMESRC><![CDATA[/xml/project_setting_step01.xml]]></FRAMESRC>
                            <MENUID><![CDATA[grp_step1]]></MENUID>
                        </w2:row>
                        <w2:row>
                            <INDEX><![CDATA[2]]></INDEX>
                            <FRAMEID><![CDATA[wfm_project_setting_step2]]></FRAMEID>
                            <FRAMESRC><![CDATA[/xml/project_setting_step02.xml]]></FRAMESRC>
                            <MENUID><![CDATA[grp_step2]]></MENUID>
                        </w2:row>
<!--                        <w2:row>-->
<!--                            <INDEX><![CDATA[3]]></INDEX>-->
<!--                            <FRAMEID><![CDATA[wfm_project_setting_step3]]></FRAMEID>-->
<!--                            <FRAMESRC><![CDATA[/xml/project_setting_step03.xml]]></FRAMESRC>-->
<!--                            <MENUID><![CDATA[grp_step3]]></MENUID>-->
<!--                        </w2:row>-->
                        <w2:row>
                            <INDEX><![CDATA[4]]></INDEX>
                            <FRAMEID><![CDATA[wfm_project_setting_step4]]></FRAMEID>
                            <FRAMESRC><![CDATA[/xml/project_setting_step04.xml]]></FRAMESRC>
                            <MENUID><![CDATA[grp_step4]]></MENUID>
                        </w2:row>
                        <w2:row>
                            <INDEX><![CDATA[5]]></INDEX>
                            <FRAMEID><![CDATA[wfm_project_setting_step5]]></FRAMEID>
                            <FRAMESRC><![CDATA[/xml/project_setting_step05.xml]]></FRAMESRC>
                            <MENUID><![CDATA[grp_step5]]></MENUID>
                        </w2:row>
                    </w2:data>
                </w2:dataList>
                <w2:dataList id="dtl_build_setting_step1" saveRemovedData="true">
                    <w2:columnInfo>
                        <w2:column id="project_id" name="project_id" dataType="text"></w2:column>
                        <w2:column id="workspace_id" name="workspace_id" dataType="text"></w2:column>
                        <w2:column id="project_name" name="project_name" dataType="text"></w2:column>
                        <w2:column id="product_type" name="product_type" dataType="text"></w2:column>
                        <w2:column id="platform" name="platform" dataType="text"></w2:column>
                        <w2:column id="platform_language" name="platform_language" dataType="text"></w2:column>
                        <w2:column id="target_server" name="target_server" dataType="text"></w2:column>
                        <w2:column id="description" name="description" dataType="text"></w2:column>
                        <w2:column id="status" name="status" dataType="text"></w2:column>
                        <w2:column id="template_version" name="template_version" dataType="text"></w2:column>
                        <w2:column id="project_dir_path" name="project_dir_path" dataType="text"></w2:column>
                        <w2:column id="created_date" name="created_date" dataType="text"></w2:column>
                        <w2:column id="updated_date" name="updated_date" dataType="text"></w2:column>
                        <w2:column id="builder_id" name="builder_id" dataType="text"></w2:column>
                        <w2:column id="vcs_id" name="vcs_id" dataType="text"></w2:column>
                        <w2:column id="ftp_id" name="ftp_id" dataType="text"></w2:column>
                        <w2:column id="key_id" name="key_id" dataType="text"></w2:column>
                    </w2:columnInfo>
                </w2:dataList>
                <w2:dataList id="dtl_build_setting_step2" saveRemovedData="true">
                    <w2:columnInfo>
                        <w2:column id="project_setting_id" name="project_setting_id" dataType="text"></w2:column>
                        <w2:column id="project_id" name="project_id" dataType="text"></w2:column>
                        <w2:column id="app_id" name="app_id" dataType="text"></w2:column>
                        <w2:column id="app_name" name="app_name" dataType="text"></w2:column>
                        <w2:column id="app_version" name="app_version" dataType="text"></w2:column>
                        <w2:column id="app_version_code" name="app_version_code" dataType="text"></w2:column>
                        <w2:column id="server_URL" name="server_URL" dataType="text"></w2:column>
                        <w2:column id="package_name" name="package_name" dataType="text"></w2:column>
                        <w2:column id="min_target_version" name="min_target_version" dataType="text"></w2:column>
                    </w2:columnInfo>
                </w2:dataList>
                <w2:dataList id="dtl_build_setting_step2_temp" saveRemovedData="true">
                    <w2:columnInfo>
                        <w2:column id="project_setting_id" name="project_setting_id" dataType="text"></w2:column>
                        <w2:column id="project_id" name="project_id" dataType="text"></w2:column>
                        <w2:column id="app_id" name="app_id" dataType="text"></w2:column>
                        <w2:column id="app_name" name="app_name" dataType="text"></w2:column>
                        <w2:column id="app_version" name="app_version" dataType="text"></w2:column>
                        <w2:column id="app_version_code" name="app_version_code" dataType="text"></w2:column>
                        <w2:column id="server_URL" name="server_URL" dataType="text"></w2:column>
                        <w2:column id="package_name" name="package_name" dataType="text"></w2:column>
                    </w2:columnInfo>
                </w2:dataList>
                <w2:dataList id="dtl_plugin_setting_installed_step4" saveRemovedData="true">
                    <w2:columnInfo>
                        <w2:column id="installed_plugin_module" name="installed_plugin_module" dataType="text"></w2:column>
                        <w2:column id="installed_plugin_version" name="installed_plugin_version" dataType="text"></w2:column>
                        <w2:column id="installed_plugin_name" name="installed_plugin_name" dataType="text"></w2:column>
                        <w2:column id="installed_plugin_type" name="installed_plugin_type" dataType="text"></w2:column>
                    </w2:columnInfo>
                </w2:dataList>
                <w2:dataList id="dtl_plugin_setting_available_step4" saveRemovedData="true">
                    <w2:columnInfo>
                        <w2:column id="available_plugin_module" name="available_plugin_module" dataType="text"></w2:column>
                        <w2:column id="available_plugin_version" name="available_plugin_version" dataType="text"></w2:column>
                        <w2:column id="available_plugin_name" name="available_plugin_name" dataType="text"></w2:column>
                        <w2:column id="available_plugin_type" name="available_plugin_type" dataType="text"></w2:column>
                    </w2:columnInfo>
                </w2:dataList>
                <w2:dataList id="dtl_plugin_setting_available_basic_step4" saveRemovedData="true">
                    <w2:columnInfo>
                        <w2:column id="available_plugin_module" name="available_plugin_module" dataType="text"></w2:column>
                        <w2:column id="available_plugin_version" name="available_plugin_version" dataType="text"></w2:column>
                        <w2:column id="available_plugin_name" name="available_plugin_name" dataType="text"></w2:column>
                        <w2:column id="available_plugin_type" name="available_plugin_type" dataType="text"></w2:column>
                    </w2:columnInfo>
                </w2:dataList>
                <w2:dataList id="dtl_deploy_setting_step5" saveRemovedData="true">
                    <w2:columnInfo>
                        <w2:column id="deploy_id" name="deploy_id" dataType="text"></w2:column>
                        <w2:column id="build_id" name="build_id" dataType="text"></w2:column>
                        <w2:column id="all_package_name" name="all_package_name" dataType="text"></w2:column>
                        <w2:column id="apple_key_id" name="apple_key_id" dataType="text"></w2:column>
                        <w2:column id="apple_issuer_id" name="apple_issuer_id" dataType="text"></w2:column>
                        <w2:column id="created_date" name="created_date" dataType="text"></w2:column>
                        <w2:column id="updated_date" name="updated_date" dataType="text"></w2:column>
                        <w2:column id="all_signingkey_id" name="all_signingkey_id" dataType="text"></w2:column>
                    </w2:columnInfo>
                </w2:dataList>
            </w2:dataCollection>
            <w2:workflowCollection>
            </w2:workflowCollection>
        </xf:model>
         <script type="text/javascript" lazy="false"><![CDATA[
            scwin.getResultAppConfigData;
            scwin.txt_project_all_step_platform = "";
            scwin.onpageload = function() {
                var project_id = localStorage.getItem("buildProjecPkId");
                scwin.select_build_project_id(project_id);
                // scwin.select_build_setting_id(project_id);
                scwin.select_deploy_setting_id(project_id);
            };

            scwin.onpageunload = function() {
                localStorage.removeItem("buildProjecPkId");
            };

            scwin.selected_step = function(selected){
                var jsonData = dtl_steps.getAllJSON();
                for(var obj in jsonData){
                    var row = jsonData[obj];
                    if(row.INDEX == selected){
                        var temp = $p.getComponentById(row.FRAMEID);
                        if(temp.getSrc() == ""){
                            temp.setSrc(row.FRAMESRC);
                        }
                        $p.getComponentById(row.FRAMEID).show();
                        $p.getComponentById(row.MENUID).addClass("on");
                    } else {
                        $p.getComponentById(row.FRAMEID).hide();
                        $p.getComponentById(row.MENUID).removeClass("on");
                    }
                }
            };

            scwin.select_build_project_id = function(build_id){
                // /api/builproject/{id}  ajax 호출
                $.ajax({
                    url : "/manager/build/project/search/projectConfig/"+build_id,
                    type : "get",
                    accept : "application/json",
                    async : false,
                    contentType : "application/json; charset=utf-8",
                    success : function(e) {
                        var data = e;
                        if(data !== null){
                            var buildproj = [];
                            var temp = {};

                            temp["project_id"]	= data.project_id;
                            temp["workspace_id"] = data.workspace_id;
                            temp["project_name"] = data.project_name;
                            temp["product_type"] = data.product_type;
                            temp["platform"] = data.platform;
                            temp["platform_language"] = data.platform_language;
                            temp["template_version"] = data.template_version;
                            temp["project_dir_path"] = data.project_dir_path;
                            temp["target_server"] = data.target_server;
                            temp["description"]	= data.description;
                            temp["status"] = data.status;
                            temp["created_date"] = data.created_date;
                            temp["updated_date"] = data.updated_date;
                            temp["builder_id"] = data.builder_id;
                            temp["ftp_id"] = data.ftp_id;
                            temp["vcs_id"] = data.vcs_id;
                            temp["key_id"] = data.key_id;

                            buildproj.push(temp);

                            var distict = common.unique(buildproj, 'project_id');
                            dtl_build_setting_step1.setJSON(distict);
                            var message = common.getLabel("lbl_project_setting_title");
                            txt_setting_project_name.setValue(data.project_name+" "+message); // Project 설정
                            localStorage.setItem("__workspace_id__",data.workspace_id);
                            wfm_project_setting_step1.setSrc("/xml/project_setting_step01.xml");

                        }

                    }
                    , error:function(request,status,error){
                        alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
                    }

                });

            };

            scwin.select_build_setting_id = function(project_id){
                $.ajax({
                    url : "/manager/build/setting/search/projectDetail/"+project_id,
                    type : "get",
                    async : false,
                    accept : "application/json",
                    contentType : "application/json; charset=utf-8",
                    success : function(e) {
                        var data = e;
                        //console.log("builprojects success r: " + data);
                        if(data !== null){
                            var buildsetting = [];
                            var temp = {};

                            temp["project_setting_id"]	= data.project_setting_id;
                            temp["project_id"] = data.project_id;
                            // temp["platform_language"] = data.platform_language;
                            temp["app_id"]	= data.app_id;
                            temp["app_name"] = data.app_name;
                            temp["app_version"] = data.app_version;
                            temp["app_version_code"] = data.app_version_code;
                            temp["package_name"] = data.package_name;
                            temp["min_target_version"] = data.min_target_version;
                            // temp["server_URL"] = data.server_URL;
                            // temp["created_date"] = data.created_date;
                            // temp["updated_date"] = data.updated_date;
                            if (data.platform_type == "Windows"){
                                var message = common.getLabel("lbl_project_setting_js_check_setting");
                                btn_proejct_step03.setValue(message); //설정 조회
                            }else {
                                var message = common.getLabel("lbl_project_setting_js_check_server_setting");
                                btn_proejct_step03.setValue(message); //Server 설정 조회

                            }

                            buildsetting.push(temp);
                            localStorage.setItem("build_setting2_pid",data.project_setting_id);
                            var distict = common.unique(buildsetting, 'project_setting_id');
                            dtl_build_setting_step2.setJSON(distict);
                            dtl_build_setting_step2_temp.setJSON(distict);

                        }

                    }
                    , error:function(request,status,error){
                        alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
                    }
                });

            };

            scwin.select_deploy_setting_id =  function(build_id){
                // deploy setting cotroller 구현하기
                $.ajax({
                    url : "/manager/deploy/setting/search/getBuildId/"+parseInt(build_id) ,
                    type : "get",
                    async : false,
                    accept : "application/json",
                    contentType : "application/json; charset=utf-8",
                    success : function(e) {
                        var data = e;
                        //console.log("builprojects success r ");
                        //console.log(data);
                        if(data !== null){
                            var deploysetting = [];
                            var temp = {};

                            temp["deploy_id"]	= data.deploy_id;
                            temp["build_id"] = data.build_id;
                            temp["all_package_name"] = data.all_package_name;
                            temp["all_signingkey_id"] = data.all_signingkey_id;
                            temp["apple_issuer_id"] = data.apple_issuer_id;
                            temp["apple_key_id"] = data.apple_key_id;
                            temp["created_date"] = data.created_date;
                            temp["updated_date"] = data.updated_date;

                            deploysetting.push(temp);
                            localStorage.setItem("deploy_setting_pid",data.deploy_id);
                            var distict = common.unique(deploysetting, 'deploy_id');
                            dtl_deploy_setting_step5.setJSON(distict);

                        }

                    }
                    , error:function(request,status,error){
                        alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
                    }
                });

            };

            scwin.btn_proejct_step01_onclick = function(e) {
                scwin.selected_step(1);

            };

            scwin.btn_proejct_step02_onclick = function(e) {
                scwin.selected_step(2);
            };

            scwin.btn_proejct_step03_onclick = function(e) {
                scwin.selected_step(3);
            };

            scwin.btn_proejct_step04_onclick = function(e) {
                scwin.selected_step(4);
            };

            scwin.btn_proejct_step05_onclick = function(e) {
                scwin.selected_step(5);
            };

	]]></script>
    </head>
    <body ev:onpageload="scwin.onpageload" ev:onpageunload="scwin.onpageunload">
    	<xf:group style="" id="" class="sub_contents">
    		<xf:group style="" id="" class="white_board">
    			<xf:group class="pgtbox" id="" style="">
    				<w2:textbox class="pgt_tit fl" id="txt_setting_project_name" label="" style="" useLocale="true" localeRef="lbl_project_setting_title"></w2:textbox>
    			</xf:group>
                <xf:group class="step_box" id="" style="" tagname="ul">
                    <xf:group class="" id="grp_step1" style="" tagname="li">
                        <w2:span id="" label="" style="" useLocale="true" localeRef="lbl_no_1"></w2:span>
                        <w2:anchor id="btn_proejct_step01" outerDiv="false" style="" ev:onclick="scwin.btn_proejct_step01_onclick" useLocale="true" localeRef="lbl_input_project">
                            <xf:label><![CDATA[]]></xf:label>
                        </w2:anchor>
                    </xf:group>
                    <xf:group class="" id="grp_step2" style="" tagname="li">
                        <w2:span id="" label="" style="" useLocale="true" localeRef="lbl_no_2"></w2:span>
                        <w2:anchor id="btn_proejct_step02" outerDiv="false" style="" ev:onclick="scwin.btn_proejct_step02_onclick" useLocale="true" localeRef="lbl_app_default_info">
                            <xf:label><![CDATA[]]></xf:label>
                        </w2:anchor>
                    </xf:group>
<!--                    <xf:group class="" id="grp_step3" style="" tagname="li">-->
<!--                        <w2:span id="" label="3" style=""></w2:span>-->
<!--                        <w2:anchor id="btn_proejct_step03" outerDiv="false" style="" ev:onclick="scwin.btn_proejct_step03_onclick">-->
<!--                            <xf:label><![CDATA[Server 정보 설정]]></xf:label>-->
<!--                        </w2:anchor>-->
<!--                    </xf:group>-->
                    <xf:group class="" id="grp_step4" style="" tagname="li">
                        <w2:span id="" label="" style="" useLocale="true" localeRef="lbl_no_3"></w2:span>
                        <w2:anchor id="btn_proejct_step04" outerDiv="false" style="" ev:onclick="scwin.btn_proejct_step04_onclick" useLocale="true" localeRef="lbl_plugin_setting">
                            <xf:label><![CDATA[]]></xf:label>
                        </w2:anchor>
                    </xf:group>
                    <xf:group class="" id="grp_step5" style="" tagname="li">
                        <w2:span id="" label="" style="" useLocale="true" localeRef="lbl_no_4"></w2:span>
                        <w2:anchor id="btn_proejct_step05" outerDiv="false" style="" ev:onclick="scwin.btn_proejct_step05_onclick" useLocale="true" localeRef="lbl_distribution_setting">
                            <xf:label><![CDATA[]]></xf:label>
                        </w2:anchor>
                    </xf:group>
                </xf:group>
    			<w2:wframe id="wfm_project_setting_step1" style="display:none;" src="" scope="true"></w2:wframe>
                <w2:wframe id="wfm_project_setting_step2" style="display:none;" src="" scope="true"></w2:wframe>
                <w2:wframe id="wfm_project_setting_step3" style="display:none;" src="" scope="true"></w2:wframe>
                <w2:wframe id="wfm_project_setting_step4" style="display:none;" src="" scope="true"></w2:wframe>
                <w2:wframe id="wfm_project_setting_step5" style="display:none;" src="" scope="true"></w2:wframe>
    		</xf:group>
    	</xf:group>
    </body>
</html>
